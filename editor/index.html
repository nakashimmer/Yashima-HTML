<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>入力</title>
		<link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
		<link rel="stylesheet" href="style.css">
		<script src="jquery-1.11.1.js"></script>
	</head>
	<body>
		
		<div id=wrap>
	
			<h1>簡易テキストエディタβ版</h1>
	
			<div id=outer>
				<div id="no"></div>

				<textarea id="editor" name="fragment" spellcheck="false" form="w3c"></textarea>

			</div>
			<p class=flex>
				<button id="btn" class="btn">閲覧</button>
				<a class="temp btn" id="download" href="#" download="noname.html" onclick="dl()">DL</a>
				<button id="temp1" class="temp btn">3</button>
				<button id="temp4" class="temp btn">4</button>
				<button id="temp5" class="temp btn">5</button>
				<button id="temp6-1" class="temp btn">6-1</button>
				<button id="temp6-2" class="temp btn">6-2</button>
				<button id="temp7" class="temp btn">7</button>
				<button id="temp8" class="temp btn">8</button>
				<button id="temp9-1" class="temp btn">9-1</button>
				<button id="temp9-2" class="temp btn">9-2</button>
				<button id="temp10" class="temp btn">10</button>
				<button id="temp11" class="temp btn">11</button>
				<button id="temp12" class="temp btn">12</button>
				<button id="temp13" class="temp btn">13</button>
				<button id="clrbtn" class="btn">消去</button>
				<input class="temp btn" type="submit" value="チェック" form="w3c">
				
			</p>

			<!-- DL -->

			<script>
				function dl() {
					var content = $id("editor").value;
					var blob = new Blob([ content ],{"type":"text/plain"});
					$id("download").href = window.URL.createObjectURL(blob);
				}
			</script>

			<!-- /DL -->
		</div>

		<form id="w3c" method="post" enctype="multipart/form-data" action="https://validator.w3.org/check" >
			<input type="hidden" name="prefill" value="0">
			<input type="hidden" name="doctype"  value="Inline">
			<input type="hidden" name="prefill_doctype" value="html5">
		</form>	

<script>
var content=localStorage.getItem("editor_contents");
if(content){$id("editor").value=content;}

$id("btn").addEventListener("click",function(){
	var editor = $id("editor");
	editor =editor.value;
	var w = window.open("","sample");
	var doc=w.document;
	doc.open();
	doc.write(editor);
	doc.close();
});

$id("editor").addEventListener("mousemove",function(){
	localStorage.setItem("editor_contents",$id("editor").value);
});

$id("clrbtn").addEventListener("click",function(){
	localStorage.clear();
	editor.value="";
});

function $id(id){
	return document.getElementById(id);
}

$(function(){
$("textarea").on('keydown', function(e){
	// tabキー押下時の対応
	if (e.which == 9 || e.keyCode == 9) {
		e.preventDefault();
		var pos = this.selectionStart;
		var text = $(this).val();
		// tabの挿入
		$(this).val(text.substr(0,pos) + '\t' + text.substr(pos, text.length));
		// カーソルの場所を移動
		this.setSelectionRange(pos + 1, pos + 1);
		}
	});
});
	
for(let i=1;i<=5000/30;i++){
	$id("no").innerHTML+="<div>"+i+":</div>";
}	
	
</script>

<script src="temp.js"></script>
			
		
	</body>
</html>

